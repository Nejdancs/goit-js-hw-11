{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,4BAQIC,EACAC,EACAC,EACAC,E,oDAEEC,EAAW,IAAIC,E,YAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,IACdC,eAAgB,K,SA+CHC,EAAaC,EAAOC,G,OAApBC,EAAYC,MAAAC,KAAAC,W,SAAZH,I,OAAAA,EAAfP,EAAAP,EAAA,CAAAO,EAAAW,GAAAC,MAAA,SAAAC,EAA4BR,EAAOC,G,IAIHQ,EAApBC,EAAMC,E,kFAFdC,I,UAEkC,EAAAC,EAAAC,SAAUd,EAAOC,G,UAAvBQ,EAA4BM,EAAAC,KAAhDN,EAAoBD,EAApBC,KAAMC,EAAcF,EAAdE,UAEdC,IACAK,EAAgBN,GAEE,IAAdA,EAAe,C,uBACjBO,EAAAC,OAAOC,QACL,4E,2BAIgB,IAATnB,GACTiB,EAAAC,OAAOE,QAAQ,oBAA8BC,OAAVX,EAAU,a,QAG/CY,EAAAT,QAAKU,QAAQC,mBAAmB,aAAa,EAAAC,EAAAZ,SAAYJ,IACzDhB,EAASiC,UACTC,IACAC,I,kDAEAC,QAAQC,IAAIhB,EAAAiB,GAAMC,SAClBrB,IACAM,EAAAC,OAAOC,QAAQ,iD,2DA1BQjB,MAAAC,KAAAC,WA8B3B,SAASuB,IACP,IACIM,EADIC,EAAuBZ,EAAAT,QAAKsB,KAAKC,wBAAjCC,OAINJ,EADW,IAAT5C,EACU6C,EAEA1C,EAGd8C,OAAOC,SAAS,CACdC,IAAKP,EACLQ,SAAU,WAId,SAASzB,EAAgBN,GACvBpB,EAAaoD,KAAKC,KAAKjC,EAAY,IAGrC,SAASkB,IACPN,EAAAT,QAAK+B,QAAQC,UAAUC,OAAO,aAGhC,SAASC,IACPzB,EAAAT,QAAK+B,QAAQC,UAAUG,IAAI,aAG7B,SAASrC,IACPW,EAAAT,QAAKoC,QAAQJ,UAAUK,OAAO,aAvGhC5B,EAAAT,QAAKsB,KAAKgB,iBAAiB,UAG3B,SAAkBC,GAChBA,EAAEC,iBAEF,IAIMC,EAFFF,EAAEG,cADJC,SAAYC,YAGsB1D,MAAM2D,OAO1C,GANAnE,EAAmB+D,EAEnBhC,EAAAT,QAAKU,QAAQoC,UAAY,GACzBZ,IACA1D,EAAO,GAEFE,EAGH,YAFA0B,EAAAC,OAAOC,QAAQ,8BAKjBrB,EAAaP,EAAkBF,GAE/B+D,EAAEG,cAAcK,WAxBlBtC,EAAAT,QAAK+B,QAAQO,iBAAiB,SA2B9B,WAME,GALA9D,GAAQ,EAERG,EAAgB8B,EAAAT,QAAKU,QAAQsC,iBAAiBzB,wBAAwBI,IACtEO,IAEI1D,EAAOC,EAIT,YAHA2B,EAAAC,OAAOC,QACL,8DAKJrB,EAAaP,EAAkBF,M","sources":["src/js/01-gallery.js"],"sourcesContent":["import './scroll-form.js';\nimport refs from './refs';\nimport getImages from './fetch-service';\nimport createCards from './create-cards';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet page;\nlet totalPages;\nlet valueSearchQuery;\nlet cordLastItems;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadBtn.addEventListener('click', onLoadBtn);\n\nfunction onSearch(e) {\n  e.preventDefault();\n\n  const {\n    elements: { searchQuery },\n  } = e.currentTarget;\n\n  const normalizedValue = searchQuery.value.trim();\n  valueSearchQuery = normalizedValue;\n\n  refs.gallery.innerHTML = '';\n  hideLoadBtn();\n  page = 1;\n\n  if (!valueSearchQuery) {\n    Notify.failure(\"You didn't enter anything.\");\n\n    return;\n  }\n\n  renderImages(valueSearchQuery, page);\n\n  e.currentTarget.reset();\n}\n\nfunction onLoadBtn() {\n  page += 1;\n\n  cordLastItems = refs.gallery.lastElementChild.getBoundingClientRect().top;\n  hideLoadBtn();\n\n  if (page > totalPages) {\n    Notify.failure(\n      \"We're sorry, but you've reached the end of search results.\"\n    );\n    return;\n  }\n\n  renderImages(valueSearchQuery, page);\n}\n\nasync function renderImages(value, page) {\n  try {\n    toggleSpiner();\n\n    const { hits, totalHits } = await getImages(value, page);\n\n    toggleSpiner();\n    checkTotalPages(totalHits);\n\n    if (totalHits === 0) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n\n      return;\n    } else if (page === 1) {\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n    }\n\n    refs.gallery.insertAdjacentHTML('beforeend', createCards(hits));\n    lightbox.refresh();\n    scroll();\n    showLoadBtn();\n  } catch (error) {\n    console.log(error.message);\n    toggleSpiner();\n    Notify.failure('Oops, something went wrong. Please try again.');\n  }\n}\n\nfunction scroll() {\n  const { height: formHeight } = refs.form.getBoundingClientRect();\n  let topScroll;\n\n  if (page === 1) {\n    topScroll = formHeight;\n  } else {\n    topScroll = cordLastItems;\n  }\n\n  window.scrollBy({\n    top: topScroll,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkTotalPages(totalHits) {\n  totalPages = Math.ceil(totalHits / 40);\n}\n\nfunction showLoadBtn() {\n  refs.loadBtn.classList.remove('is-hidden');\n}\n\nfunction hideLoadBtn() {\n  refs.loadBtn.classList.add('is-hidden');\n}\n\nfunction toggleSpiner() {\n  refs.spinner.classList.toggle('is-hidden');\n}\n"],"names":["$61aA4","parcelRequire","$233487bcc61af585$var$page","$233487bcc61af585$var$totalPages","$233487bcc61af585$var$valueSearchQuery","$233487bcc61af585$var$cordLastItems","$233487bcc61af585$var$lightbox","$parcel$interopDefault","captionsData","captionDelay","overlayOpacity","$233487bcc61af585$var$renderImages","value","page1","$233487bcc61af585$var$_renderImages","apply","this","arguments","$5eMmT","mark","_callee","ref","hits","totalHits","$233487bcc61af585$var$toggleSpiner","$fPt28","default","_ctx","sent","$233487bcc61af585$var$checkTotalPages","$aOaai","Notify","failure","success","concat","$lfmFS","gallery","insertAdjacentHTML","$jV7Iq","refresh","$233487bcc61af585$var$scroll","$233487bcc61af585$var$showLoadBtn","console","log","t0","message","topScroll","formHeight","form","getBoundingClientRect","height","window","scrollBy","top","behavior","Math","ceil","loadBtn","classList","remove","$233487bcc61af585$var$hideLoadBtn","add","spinner","toggle","addEventListener","e","preventDefault","normalizedValue","currentTarget","elements","searchQuery","trim","innerHTML","reset","lastElementChild"],"version":3,"file":"01-gallery.9568c9c4.js.map"}