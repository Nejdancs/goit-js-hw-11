{"mappings":"qhBAAAA,EAAA,S,wDAQA,IAAIC,EACAC,EACAC,EACAC,EAEJ,MAAMC,EAAW,IAAIC,E,YAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,IACdC,eAAgB,KA2ClBC,eAAeC,EAAaC,EAAOC,GACjC,IACEC,IAEA,MAAMC,KAAEA,EAAIC,UAAEA,SAAoB,EAAAC,EAAAC,SAAUN,EAAOC,GAKnD,GAHAC,IA+CJ,SAAyBE,GACvBd,EAAaiB,KAAKC,KAAKJ,EAAY,IA/CjCK,CAAgBL,GAEE,IAAdA,EAKF,YAJAM,EAAAC,OAAOC,QACL,4EAYJ,GARoB,IAATX,GACTS,EAAAC,OAAOE,KAAK,oBAAoBT,aAGlCU,EAAAR,QAAKS,QAAQC,mBAAmB,aAAa,EAAAC,EAAAX,SAAYH,IACzDV,EAASyB,UAiBb,WACE,MAAQC,OAAQC,GAAeN,EAAAR,QAAKe,KAAKC,wBACzC,IAAIC,EAGFA,EADW,IAATlC,EACU+B,EAEA5B,EAGdgC,OAAOC,SAAS,CACdC,IAAKH,EACLI,SAAU,WA5BVC,GAEI3B,GAAQX,EAIV,YAHAoB,EAAAC,OAAOkB,QACL,8DAiCNf,EAAAR,QAAKwB,QAAQC,UAAUC,OAAO,aA5B5B,MAAOC,GACPC,QAAQC,IAAIF,EAAMG,SAClBlC,IACAQ,EAAAC,OAAOC,QAAQ,kDA4BnB,SAASyB,IACPvB,EAAAR,QAAKwB,QAAQC,UAAUO,IAAI,aAG7B,SAASpC,IACPY,EAAAR,QAAKiC,QAAQR,UAAUS,OAAO,aA1GhC1B,EAAAR,QAAKe,KAAKoB,iBAAiB,UAG3B,SAAkBC,GAChBA,EAAEC,iBAEF,MACEC,UAAUC,YAAEA,IACVH,EAAEI,cAEAC,EAAkBF,EAAY7C,MAAMgD,OAO1C,GANAzD,EAAmBwD,EAEnBjC,EAAAR,QAAKS,QAAQkC,UAAY,GACzBZ,IACAhD,EAAO,GAEFE,EAGH,YAFAmB,EAAAC,OAAOE,KAAK,8BAKdd,EAAaR,EAAkBF,GAE/BqD,EAAEI,cAAcI,WAxBlBpC,EAAAR,QAAKwB,QAAQW,iBAAiB,SA2B9B,WACEpD,GAAQ,EAERG,EAAgBsB,EAAAR,QAAKS,QAAQoC,iBAAiB7B,wBAAwBI,IACtEW,IACAH,QAAQC,IAAI9C,GACZ6C,QAAQC,IAAI7C,GACZ4C,QAAQC,IAAI9C,GAAQC,GAEpBS,EAAaR,EAAkBF","sources":["src/js/01-gallery.js"],"sourcesContent":["import './scroll-form.js';\nimport refs from './refs';\nimport getImages from './fetch-service';\nimport createCards from './create-cards';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet page;\nlet totalPages;\nlet valueSearchQuery;\nlet cordLastItems;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nrefs.form.addEventListener('submit', onSearch);\nrefs.loadBtn.addEventListener('click', onLoadBtn);\n\nfunction onSearch(e) {\n  e.preventDefault();\n\n  const {\n    elements: { searchQuery },\n  } = e.currentTarget;\n\n  const normalizedValue = searchQuery.value.trim();\n  valueSearchQuery = normalizedValue;\n\n  refs.gallery.innerHTML = '';\n  hideLoadBtn();\n  page = 1;\n\n  if (!valueSearchQuery) {\n    Notify.info(\"You didn't enter anything.\");\n\n    return;\n  }\n\n  renderImages(valueSearchQuery, page);\n\n  e.currentTarget.reset();\n}\n\nfunction onLoadBtn() {\n  page += 1;\n\n  cordLastItems = refs.gallery.lastElementChild.getBoundingClientRect().top;\n  hideLoadBtn();\n  console.log(page);\n  console.log(totalPages);\n  console.log(page >= totalPages);\n\n  renderImages(valueSearchQuery, page);\n}\n\nasync function renderImages(value, page) {\n  try {\n    toggleSpiner();\n\n    const { hits, totalHits } = await getImages(value, page);\n\n    toggleSpiner();\n    checkTotalPages(totalHits);\n\n    if (totalHits === 0) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n\n      return;\n    } else if (page === 1) {\n      Notify.info(`Hooray! We found ${totalHits} images.`);\n    }\n\n    refs.gallery.insertAdjacentHTML('beforeend', createCards(hits));\n    lightbox.refresh();\n    scroll();\n\n    if (page >= totalPages) {\n      Notify.warning(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n      return;\n    }\n    showLoadBtn();\n  } catch (error) {\n    console.log(error.message);\n    toggleSpiner();\n    Notify.failure('Oops, something went wrong. Please try again.');\n  }\n}\n\nfunction scroll() {\n  const { height: formHeight } = refs.form.getBoundingClientRect();\n  let topScroll;\n\n  if (page === 1) {\n    topScroll = formHeight;\n  } else {\n    topScroll = cordLastItems;\n  }\n\n  window.scrollBy({\n    top: topScroll,\n    behavior: 'smooth',\n  });\n}\n\nfunction checkTotalPages(totalHits) {\n  totalPages = Math.ceil(totalHits / 40);\n}\n\nfunction showLoadBtn() {\n  refs.loadBtn.classList.remove('is-hidden');\n}\n\nfunction hideLoadBtn() {\n  refs.loadBtn.classList.add('is-hidden');\n}\n\nfunction toggleSpiner() {\n  refs.spinner.classList.toggle('is-hidden');\n}\n"],"names":["parcelRequire","$14e4adfa3a7594da$var$page","$14e4adfa3a7594da$var$totalPages","$14e4adfa3a7594da$var$valueSearchQuery","$14e4adfa3a7594da$var$cordLastItems","$14e4adfa3a7594da$var$lightbox","$parcel$interopDefault","captionsData","captionDelay","overlayOpacity","async","$14e4adfa3a7594da$var$renderImages","value","page1","$14e4adfa3a7594da$var$toggleSpiner","hits","totalHits","$3ihO5","default","Math","ceil","$14e4adfa3a7594da$var$checkTotalPages","$3CcrP","Notify","failure","info","$8nyf9","gallery","insertAdjacentHTML","$h6aF5","refresh","height","formHeight","form","getBoundingClientRect","topScroll","window","scrollBy","top","behavior","$14e4adfa3a7594da$var$scroll","warning","loadBtn","classList","remove","error","console","log","message","$14e4adfa3a7594da$var$hideLoadBtn","add","spinner","toggle","addEventListener","e","preventDefault","elements","searchQuery","currentTarget","normalizedValue","trim","innerHTML","reset","lastElementChild"],"version":3,"file":"01-gallery.cbbd0956.js.map"}