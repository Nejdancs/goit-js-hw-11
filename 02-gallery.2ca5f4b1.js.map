{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,0BAMA,IAAIC,EACAC,EACAC,EAEJ,MAAMC,EAAW,IAAIC,E,YAAJ,CAAmB,aAAc,CAChDC,aAAc,MACdC,aAAc,IACdC,eAAgB,KA2BlB,SAASC,IACP,IAAIC,EAAQX,EAAAY,QAAKC,QACjBC,QAAQC,IAAIC,KAAKC,OAEjB,IAAIC,EAAgBP,EAAMQ,aAK1B,GAJcC,OAAOC,YACDD,OAAOE,aAGlBJ,EAAe,CAItB,GAHAhB,GAAQ,EACRqB,oBAAoB,SAAUb,GAE1BR,EAAOC,EAKT,YAJAqB,EAAAC,OAAOC,QACL,8DAMJC,EAAavB,EAAkBF,IAInC0B,eAAeD,EAAaE,EAAOC,GACjC,IACEC,IAEA,MAAMC,KAAEA,EAAIC,UAAEA,SAAoB,EAAAC,EAAAtB,SAAUiB,EAAOC,GAKnD,GAHAC,IAsEJ,SAAyBE,GACvB9B,EAAagC,KAAKC,KAAKH,EAAY,IAtEjCI,CAAgBJ,GAEE,IAAdA,EAKF,YAJAT,EAAAC,OAAOC,QACL,4EAIgB,IAATI,GACTN,EAAAC,OAAOa,QAAQ,oBAAoBL,aAGrCjC,EAAAY,QAAKC,QAAQ0B,mBAAmB,YAAyBP,EAWxDQ,KAAIC,IACH,MAAMC,aACJA,EAAYC,cACZA,EAAaC,KACbA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,GACEP,EAEJ,MAAO,wCACAE,gBAA4BD,WAAsBE,gGAG3CC,6DAGAC,gEAGGC,iEAGCC,mCAKnBC,KAAK,KAvCN5C,EAAS6C,UA0Cb,WACE,MAAQC,OAAQC,GAAepD,EAAAY,QAAKyC,KAAKC,wBACzC,IAAIC,EAES,IAATrD,IACFqD,EAAYH,EAEZhC,OAAOoC,SAAS,CACdC,IAAKF,EACLG,SAAU,YAlDZC,GACAC,iBAAiB,SAAUlD,GAC3B,MAAOmD,GACP/C,QAAQC,IAAI8C,EAAMC,UAwDtB,SAAS/B,IACP/B,EAAAY,QAAKmD,QAAQC,UAAUC,OAAO,aAlIhCjE,EAAAY,QAAKyC,KAAKO,iBAAiB,UAE3B,SAAiBM,GACfA,EAAEC,iBAEF,MACEC,UAAUC,YAAEA,IACVH,EAAEI,cAEAC,EAAkBF,EAAYxC,MAAM2C,OAM1C,GALApE,EAAmBmE,EAEnBvE,EAAAY,QAAKC,QAAQ4D,UAAY,GACzBvE,EAAO,GAEFE,EACH,OAGFuB,EAAavB,EAAkBF,GAE/BgE,EAAEI,cAAcI","sources":["src/js/02-gallery.js"],"sourcesContent":["import refs from './refs';\nimport getImages from './fetch-service';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet page;\nlet totalPages;\nlet valueSearchQuery;\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n  overlayOpacity: 0.8,\n});\n\nrefs.form.addEventListener('submit', onSearh);\n\nfunction onSearh(e) {\n  e.preventDefault();\n\n  const {\n    elements: { searchQuery },\n  } = e.currentTarget;\n\n  const normalizedValue = searchQuery.value.trim();\n  valueSearchQuery = normalizedValue;\n\n  refs.gallery.innerHTML = '';\n  page = 1;\n\n  if (!valueSearchQuery) {\n    return;\n  }\n\n  renderImages(valueSearchQuery, page);\n\n  e.currentTarget.reset();\n}\n\nfunction onScroll() {\n  var block = refs.gallery;\n  console.log(Date.now());\n\n  var contentHeight = block.offsetHeight;\n  var yOffset = window.pageYOffset;\n  var window_height = window.innerHeight;\n  var y = yOffset + window_height;\n\n  if (y >= contentHeight) {\n    page += 1;\n    removeEventListener('scroll', onScroll);\n\n    if (page > totalPages) {\n      Notify.failure(\n        \"We're sorry, but you've reached the end of search results.\"\n      );\n\n      return;\n    }\n\n    renderImages(valueSearchQuery, page);\n  }\n}\n\nasync function renderImages(value, page) {\n  try {\n    toggleSpiner();\n\n    const { hits, totalHits } = await getImages(value, page);\n\n    toggleSpiner();\n    checkTotalPages(totalHits);\n\n    if (totalHits === 0) {\n      Notify.failure(\n        'Sorry, there are no images matching your search query. Please try again.'\n      );\n\n      return;\n    } else if (page === 1) {\n      Notify.success(`Hooray! We found ${totalHits} images.`);\n    }\n\n    refs.gallery.insertAdjacentHTML('beforeend', createCards(hits));\n    lightbox.refresh();\n    scroll();\n    addEventListener('scroll', onScroll);\n  } catch (error) {\n    console.log(error.message);\n  }\n}\n\nfunction createCards(imagesData) {\n  return imagesData\n    .map(imageData => {\n      const {\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = imageData;\n\n      return `<div class=\"photo-card\">\n  <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" /></a>\n  <div class=\"info\">\n    <p class=\"info-item\">\n      <b>Likes</b>${likes}\n    </p>\n    <p class=\"info-item\">\n      <b>Views</b>${views}\n    </p>\n    <p class=\"info-item\">\n      <b>Comments</b>${comments}\n    </p>\n    <p class=\"info-item\">\n      <b>Downloads</b>${downloads}\n    </p>\n  </div>\n</div>`;\n    })\n    .join('');\n}\n\nfunction scroll() {\n  const { height: formHeight } = refs.form.getBoundingClientRect();\n  let topScroll;\n\n  if (page === 1) {\n    topScroll = formHeight;\n\n    window.scrollBy({\n      top: topScroll,\n      behavior: 'smooth',\n    });\n  }\n}\n\nfunction checkTotalPages(totalHits) {\n  totalPages = Math.ceil(totalHits / 40);\n}\n\nfunction toggleSpiner() {\n  refs.spinner.classList.toggle('is-hidden');\n}\n"],"names":["$8nyf9","parcelRequire","$ee0313e07f0ac4a8$var$page","$ee0313e07f0ac4a8$var$totalPages","$ee0313e07f0ac4a8$var$valueSearchQuery","$ee0313e07f0ac4a8$var$lightbox","$parcel$interopDefault","captionsData","captionDelay","overlayOpacity","$ee0313e07f0ac4a8$var$onScroll","block","default","gallery","console","log","Date","now","contentHeight","offsetHeight","window","pageYOffset","innerHeight","removeEventListener","$3CcrP","Notify","failure","$ee0313e07f0ac4a8$var$renderImages","async","value","page1","$ee0313e07f0ac4a8$var$toggleSpiner","hits","totalHits","$3ihO5","Math","ceil","$ee0313e07f0ac4a8$var$checkTotalPages","success","insertAdjacentHTML","map","imageData","webformatURL","largeImageURL","tags","likes","views","comments","downloads","join","refresh","height","formHeight","form","getBoundingClientRect","topScroll","scrollBy","top","behavior","$ee0313e07f0ac4a8$var$scroll","addEventListener","error","message","spinner","classList","toggle","e","preventDefault","elements","searchQuery","currentTarget","normalizedValue","trim","innerHTML","reset"],"version":3,"file":"02-gallery.2ca5f4b1.js.map"}